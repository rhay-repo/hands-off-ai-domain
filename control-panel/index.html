<script>
    document.getElementById('n8nForm').addEventListener('submit', function(event) {
        event.preventDefault();
    
        const formData = {
            businessTypes: document.getElementById('businessTypes').value.toLowerCase(),
            liquor: document.getElementById('liquor').checked ? 1 : 0,
            cannabis: document.getElementById('cannabis').checked ? 1 : 0,
            cyber: document.getElementById('cyber').checked ? 1 : 0,
            flood: document.getElementById('flood').checked ? 1 : 0,
            workersComp: document.getElementById('workersComp').checked ? 1 : 0
        };
    
        fetch('https://0340-2601-140-8600-630-d471-8153-295-6c14.ngrok-free.app/webhook-test/control-panel-trigger', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(async (response) => {
            if (response.ok) {
                const data = await response.json();
                const message = data.Message || JSON.stringify(data); // ← use your returned JSON key properly
    
                const formContainer = document.querySelector('.form-container');
    
                // Fade out
                formContainer.style.transition = "opacity 0.5s ease";
                formContainer.style.opacity = 0;
    
                setTimeout(() => {
                    // Replace content
                    formContainer.innerHTML = `
                        <div style="padding: 2rem; text-align: center;">
                            <h2>Thank you!</h2>
                            <p style="margin-top: 1rem; white-space: pre-wrap;">${message}</p>
                        </div>
                    `;
                    // Fade back in
                    formContainer.style.opacity = 1;
                }, 500);
    
            } else {
                alert('There was an error submitting the data.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An unexpected error occurred.');
        })
    });
    </script>
    